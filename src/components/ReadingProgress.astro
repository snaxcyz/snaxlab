---
---

<div id="reading-progress" class="fixed left-0 top-0 z-50 h-1 w-full bg-transparent">
  <div id="reading-progress-bar" class="h-full w-0 bg-foreground/70 transition-[width] duration-150 ease-out"></div>
</div>

<script is:inline>
  const bar = document.getElementById('reading-progress-bar');
  const main = document.querySelector('main');
  // Only show progress on pages that contain an <article>
  const article = main?.querySelector('article');
  const wrapper = document.getElementById('reading-progress');
  if (!article || !bar || !wrapper) {
    wrapper?.remove();
  } else {
    const update = () => {
      const rect = article.getBoundingClientRect();
      const top = rect.top + window.scrollY;
      const height = article.scrollHeight - window.innerHeight;
      const progress = height > 0 ? (window.scrollY - top) / height : 0;
      const clamped = Math.min(1, Math.max(0, progress));
      bar.style.width = (clamped * 100).toFixed(2) + '%';
    };
    update();
    window.addEventListener('scroll', update, { passive: true });
    window.addEventListener('resize', update);
  }
</script>
